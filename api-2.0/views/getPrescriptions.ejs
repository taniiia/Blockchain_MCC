<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>View Prescriptions</title>
  <link rel="stylesheet" href="/css/styles.css">
  <style>
    body { font-family: sans-serif; padding: 1em; }
    label, select, button { display: block; margin-top: .5em; }
    select { width: 100%; padding: .5em; }
    .error   { color: red; }
    .details { margin-top: 1em; }
    .details li { margin-bottom: .25em; }
  </style>
</head>
<body>
  <h1>Prescriptions for <%= username %></h1>

  <% if (error) { %>
    <p class="error"><%= error %></p>
  <% } %>

  <form method="POST" action="/getPrescriptions">
    <label for="prescID">Select Prescription:</label>
    <select name="prescID" id="prescID" required>
      <% if (prescriptions.length) { %>
        <% prescriptions.forEach(id => { %>
          <option value="<%= id %>" <%= selected===id?'selected':'' %>><%= id %></option>
        <% }) %>
      <% } else { %>
        <option disabled>No prescriptions available</option>
      <% } %>
    </select>
    <input type="hidden" name="pharmacistID" value="<%= pharmacistID %>">
    <button type="submit">Fetch</button>
  </form>

  <% if (error) { %>
    <p class="error"><%= error %></p>
  <% } %>

  <% if (prescription) { %>
    <h2>Decrypted Prescription</h2>
    <ul class="details">
      <li><strong>Medications:</strong>     <%= prescription.medications.join(', ') %></li>
      <li><strong>Bill Amount:</strong>     â‚¹<%= prescription.billAmount %></li>
      <li><strong>Status:</strong>          <%= prescription.status %></li>
    </ul>
  <% } %>
</body>
</html>
